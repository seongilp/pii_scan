<!DOCTYPE html>
<html lang="ko" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}개인정보 스캐너{% endblock %}</title>
    {% load static %}
    <!-- shadcn/ui CSS -->
    <link href="{% static 'css/output.css' %}" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        .card {
            margin-bottom: 20px;
        }
        .alert {
            margin-top: 20px;
        }
        .table-responsive {
            margin-top: 20px;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand" href="{% url 'index' %}">개인정보 스캐너</a>
            <button class="navbar-toggler" type="button" id="navbarToggle">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
            </button>
            <div class="navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="{% url 'index' %}">홈</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if 'database-configs' in request.path %}active{% endif %}" href="{% url 'database_configs' %}">데이터베이스 설정</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if 'scan-jobs' in request.path %}active{% endif %}" href="{% url 'scan_jobs' %}">스캔 작업</a>
                    </li>
                </ul>
            </div>
            <button id="theme-toggle" class="ml-auto flex h-9 w-9 items-center justify-center rounded-md border border-input bg-background text-primary-foreground hover:bg-accent hover:text-accent-foreground">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon theme-icon-moon"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun theme-icon-sun hidden"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        {% if error_message %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {{ error_message }}
            <button type="button" class="btn-close" aria-label="Close" onclick="this.parentElement.style.display='none';">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
        </div>
        {% endif %}

        {% if success_message %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            {{ success_message }}
            <button type="button" class="btn-close" aria-label="Close" onclick="this.parentElement.style.display='none';">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
            </button>
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p class="text-muted">개인정보 스캐너 프론트엔드 &copy; 2025</p>
        </div>
    </footer>

    <!-- shadcn/ui JS -->
    <script>
        // Toggle mobile navigation
        document.addEventListener('DOMContentLoaded', function() {
            const navbarToggle = document.getElementById('navbarToggle');
            const navbarNav = document.getElementById('navbarNav');

            if (navbarToggle && navbarNav) {
                navbarToggle.addEventListener('click', function() {
                    navbarNav.classList.toggle('show');
                });
            }

            // Close alerts when clicking the close button
            document.querySelectorAll('.btn-close').forEach(button => {
                button.addEventListener('click', function() {
                    this.closest('.alert').style.display = 'none';
                });
            });

            // Theme toggle functionality
            const themeToggle = document.getElementById('theme-toggle');
            const moonIcon = document.querySelector('.theme-icon-moon');
            const sunIcon = document.querySelector('.theme-icon-sun');

            // Check for saved theme preference or use the system preference
            const savedTheme = localStorage.getItem('theme') || 
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

            // Apply the saved theme on page load
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                moonIcon.classList.add('hidden');
                sunIcon.classList.remove('hidden');
            }

            // Toggle theme when button is clicked
            themeToggle.addEventListener('click', function() {
                const isDark = document.documentElement.classList.toggle('dark');

                // Toggle icons
                if (isDark) {
                    moonIcon.classList.add('hidden');
                    sunIcon.classList.remove('hidden');
                } else {
                    moonIcon.classList.remove('hidden');
                    sunIcon.classList.add('hidden');
                }

                // Save preference to localStorage
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            });
        });
    </script>
    <!-- Custom JS -->
    {% block extra_js %}{% endblock %}
</body>
</html>
